<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Riptide</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ctext y='26' font-size='26'%3E%F0%9F%8C%8A%3C/text%3E%3C/svg%3E">
  <link rel="stylesheet" href="/vendor/xterm/css/xterm.css">
  <link rel="stylesheet" href="/css/theme.css">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <!-- Room selection screen (shown before auth) -->
  <div id="room-screen">
    <div class="rs-container">
      <h1 class="rs-title">Riptide</h1>

      <div class="rs-layout">
        <!-- Knowledge Base (LEFT COLUMN) -->
        <div class="rs-column rs-kb-column">
          <div class="rs-section">
            <h2 class="rs-section-title">Knowledge Base</h2>
            <input type="text" id="rs-kb-search" class="rs-input rs-kb-search-input" placeholder="Search techniques, tools, services..." spellcheck="false" />
            <div id="rs-kb-type-filter" class="rs-kb-type-filter"></div>
            <div id="rs-kb-tags" class="rs-kb-tags"></div>
            <div id="rs-kb-results" class="rs-kb-results"></div>
          </div>
        </div>

        <!-- Rooms (RIGHT COLUMN) -->
        <div class="rs-column rs-rooms-column">
          <div class="rs-section">
            <h2 class="rs-section-title">Available Rooms</h2>
            <div id="rs-room-list" class="rs-room-list"></div>
            <div class="rs-form">
              <input type="password" id="rs-join-password" class="rs-input" placeholder="Room password" spellcheck="false" autocomplete="off" maxlength="128" />
              <input type="text" id="rs-join-nickname" class="rs-input" placeholder="Your nickname" spellcheck="false" maxlength="32" />
              <button id="rs-join-btn" class="rs-btn rs-btn-primary">Join Selected Room</button>
              <div id="rs-join-error" class="rs-error"></div>
            </div>
          </div>

          <div class="rs-divider"><span>or create a new room</span></div>

          <div class="rs-section">
            <div class="rs-form">
              <input type="text" id="rs-create-name" class="rs-input" placeholder="Room name" spellcheck="false" maxlength="64" />
              <input type="password" id="rs-create-password" class="rs-input" placeholder="Room password" spellcheck="false" autocomplete="off" maxlength="128" />
              <input type="text" id="rs-create-nickname" class="rs-input" placeholder="Your nickname" spellcheck="false" maxlength="32" />
              <input type="text" id="rs-create-workdir" class="rs-input" placeholder="Working directory (optional, e.g. /root/engagements/lab)" spellcheck="false" maxlength="512" />
              <div class="rs-import-row">
                <label class="rs-import-label">
                  <input type="file" id="rs-import-file" accept=".zip" style="display:none" />
                  <span class="rs-import-btn">Attach Export (.zip)</span>
                </label>
                <span id="rs-import-filename" class="rs-import-filename"></span>
              </div>
              <button id="rs-create-btn" class="rs-btn rs-btn-accent">Create New Room</button>
              <div id="rs-create-error" class="rs-error"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="app" class="hidden">
    <header id="toolbar">
      <div class="toolbar-left">
        <span class="app-title">Riptide</span>
      </div>
      <div class="toolbar-right">
        <span id="room-name" class="room-badge"></span>
        <button id="btn-knowledge" class="kb-toolbar-btn" title="Knowledge Base">KB</button>
        <button id="btn-room-settings" class="room-settings-btn" title="Settings">&#9881;</button>
        <button id="btn-record" class="record-btn" title="Record terminal session">&#9679;</button>
        <div id="presence-bar"></div>
        <button id="btn-leave-room" class="leave-btn" title="Leave Room">Leave</button>
      </div>
    </header>

    <div id="tab-bar">
      <button id="btn-new-tab" class="tab-add-btn" title="New Tab">+</button>
    </div>

    <main id="main-content">
      <div id="left-panel">
        <div id="panel-tabs">
          <button class="panel-tab active" data-panel="ops">Ops</button>
          <button class="panel-tab" data-panel="playbooks">Playbooks</button>
          <button class="panel-tab" data-panel="activity">Activity</button>
          <button class="panel-tab" data-panel="files">Files</button>
        </div>
        <div id="panel-group-ops" class="panel-group">
          <div id="scope-section">
            <div id="scope-header">Target Scope</div>
            <div id="scope-list"></div>
          </div>
          <div id="variables-section">
            <div id="variables-header">Variables</div>
            <div id="variables-list"></div>
          </div>
          <div id="credentials-section">
            <div id="credentials-header">Credentials</div>
            <div id="credentials-list" class="hidden"></div>
          </div>
          <div id="scratchpad-section">
            <div id="scratchpad-header">Notes</div>
            <div id="scratchpad-list"></div>
          </div>
        </div>
        <div id="panel-group-playbooks" class="panel-group hidden">
          <div id="playbook-toolbar">
            <input type="text" id="playbook-search" placeholder="Search library..." spellcheck="false" />
            <button id="btn-browse-library" title="Browse playbook library">&#9776;</button>
            <button id="btn-capture-output" title="Paste clipboard as captured output">&dArr;</button>
            <button id="btn-import-playbook" title="Import playbook (.md)">&#8613;</button>
            <input type="file" id="playbook-import-input" accept=".md" multiple style="display:none" />
            <button id="btn-add-playbook" title="New Playbook">+</button>
            <div id="library-dropdown" class="hidden"></div>
          </div>
          <div id="playbook-stack"></div>
        </div>
        <div id="panel-group-activity" class="panel-group hidden">
          <div id="history-section">
            <div id="history-header">Command History</div>
            <div id="history-list"></div>
          </div>
          <div id="audit-section">
            <div id="audit-header">Audit Log</div>
            <div id="audit-list"></div>
          </div>
          <div id="alerts-section">
            <div id="alerts-header">Alerts</div>
            <div id="alerts-list"></div>
          </div>
          <div id="chat-section">
            <div id="chat-header">Chat</div>
            <div id="chat-list"></div>
          </div>
        </div>
        <div id="panel-group-files" class="panel-group hidden">
          <div id="files-section">
            <div id="files-header">Files</div>
            <div id="files-list"></div>
          </div>
          <div id="recordings-section">
            <div id="recordings-header">Recordings</div>
            <div id="recordings-list"></div>
          </div>
        </div>
      </div>

      <div id="splitter"></div>

      <div id="right-panel">
        <div id="terminal-header">
          <span class="terminal-header-title">Terminal</span>
          <button id="btn-add-terminal" class="terminal-add-btn" title="New terminal tab">+</button>
        </div>
        <div id="terminal-tabs" class="hidden"></div>
        <div id="terminal-container"></div>
      </div>
    </main>

    <div id="modal-overlay" class="hidden">
      <div id="modal-box"></div>
    </div>
  </div>

  <!-- Vendor libraries -->
  <script src="/vendor/xterm/lib/xterm.js"></script>
  <script src="/vendor/xterm-addon-fit/lib/addon-fit.js"></script>
  <script src="/vendor/xterm-addon-web-links/lib/addon-web-links.js"></script>
  <script src="/vendor/marked/marked.min.js"></script>
  <script src="/js/prism-init.js"></script>
  <script src="/vendor/prism/prism.js"></script>
  <script src="/vendor/prism/components/prism-bash.min.js"></script>
  <script src="/vendor/prism/components/prism-python.min.js"></script>
  <script src="/vendor/prism/components/prism-json.min.js"></script>
  <script src="/vendor/prism/components/prism-yaml.min.js"></script>
  <script src="/vendor/prism/components/prism-sql.min.js"></script>
  <script src="/vendor/codemirror/codemirror.bundle.js"></script>
  <script src="/vendor/dompurify/dist/purify.min.js"></script>

  <!-- Application modules -->
  <script src="/js/modal.js"></script>
  <script src="/js/theme.js"></script>
  <script src="/js/splitter.js"></script>
  <script src="/js/toast.js"></script>
  <script src="/js/clipboard.js"></script>
  <script src="/js/severity.js"></script>
  <script src="/js/collapsible.js"></script>
  <script src="/js/terminal.js"></script>
  <script src="/js/notes.js"></script>
  <script src="/js/library.js"></script>
  <script src="/js/variables.js"></script>
  <script src="/js/history.js"></script>
  <script src="/js/auditlog.js"></script>
  <script src="/js/scratchpad.js"></script>
  <script src="/js/files.js"></script>
  <script src="/js/alerts.js"></script>
  <script src="/js/chat.js"></script>
  <script src="/js/credentials.js"></script>
  <script src="/js/output-parser.js"></script>
  <script src="/js/preview.js"></script>
  <script src="/js/tabs.js"></script>
  <script src="/js/auth.js"></script>
  <script src="/js/api.js"></script>
  <script src="/js/knowledge.js"></script>
  <script src="/js/sync.js"></script>
  <script src="/js/presence.js"></script>
  <script src="/js/editor.js"></script>
  <script src="/js/library-browser.js"></script>
  <script src="/js/search.js"></script>
  <script src="/js/recorder.js"></script>
  <script src="/js/recordings.js"></script>
  <script src="/js/settings.js"></script>
  <script src="/js/playbooks.js"></script>
  <script src="/js/shortcuts.js"></script>
  <script src="/js/scope.js"></script>
  <script src="/js/app.js"></script>
</body>
</html>
